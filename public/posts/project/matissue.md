#### 아키텍쳐 다이어그램

![맛이슈-아키텍처.jpg](https://file.notion.so/f/f/22f608db-9f85-4b54-9281-d319030585b8/5f7e40ee-bc02-4d3e-944b-9a347985615b/%E1%84%86%E1%85%A1%E1%86%BA%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B2-%E1%84%8B%E1%85%A1%E1%84%8F%E1%85%B5%E1%84%90%E1%85%A6%E1%86%A8%E1%84%8E%E1%85%A5.jpg?id=7177b817-d819-428c-810d-5b83b90098cd&table=block&spaceId=22f608db-9f85-4b54-9281-d319030585b8&expirationTimestamp=1697817600000&signature=6gIW1DO2_-tHyZzB9lKl7iLKP4raAokDczjH1HUa3x0&downloadName=%E1%84%86%E1%85%A1%E1%86%BA%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B2-%E1%84%8B%E1%85%A1%E1%84%8F%E1%85%B5%E1%84%90%E1%85%A6%E1%86%A8%E1%84%8E%E1%85%A5.jpg)

##

#### 주요 기능

- 메일인증 을 통한 회원 가입 및 아이디 비밀번호 찾기
- session 방식을 사용한 로그인
- 요리 레시피 CRUD 기능
- 댓글 CURD 기능
- 요리 레시피 검색 및 필터링 기능
- 요리 레시피 스크랩 기능
- 프로필 편집 기능
- 유저 팔로우 기능

##

#### 부가 기능

- 다크모드
- 반응형 웹
- 최근 검색어
- 배너 및 레시피 리스트 캐러셀

##

#### 개발 경험 및 주요 담당 업무 내용

- 랜딩페이지, 레이아웃, 로그인/회원가입 페이지, 아이디/비밀번호 찾기 페이지, 관리자 페이지 담당
- Styled Components SSR 환경설정 및 Global theme 서비스 테마 변수화
- 실시간 validation 및 입력상태에 따른 ref를 활용한 input focus활용으로 생년월일 입력폼 UX 최적화
- 회원가입, 아이디, 비밀번호 찾기 페이지 메일인증 로직, 메일에서 링크 클릭시 인증 코드를 URL로 리다이렉트하여 UX향상
- 랜딩페이지 배너 및 레시피 리스트 캐러셀, UI 인터랙션 요소들 라이브러리 없이 직접 구현
- 다크모드 버튼 제작 및 Global style로 전역적으로 시멘틱 태그 분기 처리하여 효율적으로 구현
- 반응형 헤더 및 유저 메뉴 모달, 카테고리 컴포넌트 구현
- 로딩스피너, 토스트메세지, 커스텀 에러 컴포넌트, 에러 페이지 등 긍정적인 UI/UX 요소들 도입

##

#### 트러블 슈팅

1. SSR 환경에서 CSS-in-JS 사용시 페이지 로드시에 뒤늦은 스타일적용으로 인해 레이아웃 쉬프트가 일어나는 FOUC(Flash of Unstyled Content)문제

   → next.config.js의 Styled-Components 컴파일러 설정을 통해 SSR시, 미리 스타일을 입히어 해결

2. 랜딩페이지에서 모든 데이터들을 SSR로 렌더링하여 페이지 로딩 시간이 2초가 넘게걸리는 문제

   → `부분적인 SSR을 적용` (화면에 먼저 노출되는 부분은 SSR, 추후에 보여도 되는 부분은 CSR) 및, `Dynamic import`를 통한 `코드 스플리팅`으로 최적화하여 `로딩 시간을 4배이상 단축`

3. Next/Image, Sharp 패키지 를 활용하여 `이미지 크기를 최적화하여 평균적으로 20%, 최대 93%가량 감소`, `이미지 로딩속도를 2배 빠르게 개선,` 또한 placeholder 기능을 활용하여 스켈레톤 처리를 통해 데이터 레이아웃 쉬프트 방지
4. 미인증시 접근이 불가능한 페이지에 useEffect로 분기처리를 하면서 페이지 바뀜, 잠깐동안의 페이지 노출 등 부자연스러운 부분이 사용자 경험을 해치는 문제

   → `Next.js의 middleware 기능을 활용`하여 서버로의 페이지 request 단계에서 인증정보와 접근하려는 URL을 확인하여 `부자연스러운 부분 없이 부드럽게 로그인 페이지로 Redirect`하여 해결

5. middleware 기능을 사용할때 미인증시 rewrite기능을 사용하였는데, 배포 단계에서 chunk load error 가 발생하는 이슈

   → .next 폴더를 지우는 등 세간에 알려진 해결방법을 동원해봤지만 해결되지 않음, rewrite 대신 redirect 로 바꾸니까 해결 단순 해결이 끝이아니라, `chunk load error가 발생하는 원인`에 대해서 배움

6. 회원가입, 로그인 폼을 관리할 때 상태를 만들고 일일히 onChange함수를 바인딩 했었는데, 로직이 너무 복잡해지고 useRef를 사용하자니 실시간 발리데이션 여부를 인풋창 아래에 에러메세지로 표현이 어려움

   → `React-hook-form 라이브러리를 사용`하여, 폼 제출시에 일괄적으로 발리데이션을 체크하고, 이후 에러메세지를 통해 실시간으로 발리데이션 통과여부를 사용자에게 제공. 또한 `발리데이션을 상수화 및 임포트하여  코드 가독성과 유지보수성을 높임`

7. 세션 로그인 방식을 채택, 세션 아이디를 쿠키에 저장하는 방식으로 인증 로직을 구현하였는데, 서버컴포넌트에서 쿠키값을 읽지 못하는 이슈

   → 공식문서를 통해 Next 앱라우터에서 제공하는 `next/headers` 라는 기능을 활용, req 단계에서 쿠키의 값을 읽어 서버 컴포넌트에서도 인증 관련된 HTTP 요청을 하여 페이지를 SSR할 수 있었음

8. 입력 폼을 제출시 빠르게 여러번 클릭을하면 중복 제출되는 이슈

   → `폼 제출로직을 컨트롤하는 isLoading 상태`를 만들어 폼 제출시에 setIsLoading(true)를 통해 제출 `버튼을 disabled` 하였고, try catch 중 finally 블럭에서 setIsLoading(false)로 변경하여 중복제출을 방지

9. 다크모드를 Recoil로 Styled-Components마다 isDarkMode 상태를 props로 내려주어 구현시 개발 시간 및 유지보수가 비효율적인 문제

   → Styled-Component의 ThemeContext를 생성, 프로젝트의 `주요 색상들을 상수화` 하고 GlobalStyle 설정을 통해 `자주 사용하는 시멘틱 태그들을 한꺼번에 분기처리`하여 구현 속도 및 유지보수성 향상
